<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2003/10/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <rd:GridSpacing>0.025in</rd:GridSpacing>
  <PageHeader>
    <ReportItems>
      <Textbox Name="textbox15">
        <Style>
          <PaddingLeft>2pt</PaddingLeft>
          <Format>=ReportLib.Language.GetDateFormat(ReportItems!DateNumberFormat.Value, "/", "L")+" HH:mm:ss"</Format>
          <FontSize>8pt</FontSize>
          <TextAlign>Left</TextAlign>
          <PaddingBottom>2pt</PaddingBottom>
          <PaddingTop>2pt</PaddingTop>
          <PaddingRight>2pt</PaddingRight>
        </Style>
        <ZIndex>1</ZIndex>
        <rd:DefaultName>textbox15</rd:DefaultName>
        <Height>0.25in</Height>
        <Width>1.66667in</Width>
        <CanGrow>true</CanGrow>
        <Value>= Globals!ExecutionTime</Value>
      </Textbox>
      <Textbox Name="textbox13">
        <Style>
          <PaddingLeft>2pt</PaddingLeft>
          <FontSize>8pt</FontSize>
          <TextAlign>Right</TextAlign>
          <PaddingBottom>2pt</PaddingBottom>
          <PaddingTop>2pt</PaddingTop>
          <PaddingRight>2pt</PaddingRight>
        </Style>
        <rd:DefaultName>textbox13</rd:DefaultName>
        <Height>0.25in</Height>
        <Width>2.45833in</Width>
        <CanGrow>true</CanGrow>
        <Value>="Page " &amp; Globals!PageNumber &amp; " of " &amp; Globals!TotalPages</Value>
        <Left>4.85in</Left>
      </Textbox>
    </ReportItems>
    <PrintOnLastPage>true</PrintOnLastPage>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <Style />
    <Height>0.3in</Height>
  </PageHeader>
  <CodeModules>
    <CodeModule>SoftBrands.FourthShift.RDLShared, Version=1.0.7400.0, Culture=neutral, PublicKeyToken=541b4aff0f04b60a</CodeModule>
  </CodeModules>
  <RightMargin>0.4in</RightMargin>
  <Author>SoftBrands Manufacturing, Inc.</Author>
  <Body>
    <ReportItems>
      <List Name="list1">
        <Style />
        <Grouping Name="list1_Details_Group">
          <GroupExpressions>
            <GroupExpression>=Fields!CustomerID.Value</GroupExpression>
          </GroupExpressions>
        </Grouping>
        <DataSetName>IVIA</DataSetName>
        <ReportItems>
          <Table Name="table1">
            <Height>1.98095cm</Height>
            <ZIndex>11</ZIndex>
            <Style>
              <TextAlign>Center</TextAlign>
            </Style>
            <Header>
              <TableRows>
                <TableRow>
                  <Height>0.2in</Height>
                  <TableCells>
                    <TableCell>
                      <ColSpan>3</ColSpan>
                      <ReportItems>
                        <Textbox Name="textbox6">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Center</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>29</ZIndex>
                          <rd:DefaultName>textbox6</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>--------------------Ref-------------------</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ColSpan>2</ColSpan>
                      <ReportItems>
                        <Textbox Name="textbox59">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Center</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>28</ZIndex>
                          <rd:DefaultName>textbox59</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>---------------------Invoice---------------------</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ColSpan>2</ColSpan>
                      <ReportItems>
                        <Textbox Name="textbox2">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Center</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>27</ZIndex>
                          <rd:DefaultName>textbox2</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>--Adjustment--</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox17">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Center</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>26</ZIndex>
                          <rd:DefaultName>textbox17</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value />
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox28">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Center</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>25</ZIndex>
                          <rd:DefaultName>textbox28</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value />
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox32">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Right</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>24</ZIndex>
                          <rd:DefaultName>textbox32</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>C</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox37">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Right</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>23</ZIndex>
                          <rd:DefaultName>textbox37</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value />
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                </TableRow>
                <TableRow>
                  <Height>0.2in</Height>
                  <TableCells>
                    <TableCell>
                      <ColSpan>3</ColSpan>
                      <ReportItems>
                        <Textbox Name="textbox9">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BorderWidth>
                              <Bottom>1.5pt</Bottom>
                            </BorderWidth>
                            <BorderColor>
                              <Default>Navy</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Left</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>22</ZIndex>
                          <rd:DefaultName>textbox9</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>No-Seqn</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox23">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BorderWidth>
                              <Bottom>1.5pt</Bottom>
                            </BorderWidth>
                            <BorderColor>
                              <Default>Navy</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Left</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>21</ZIndex>
                          <rd:DefaultName>textbox23</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>No</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox18">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BorderWidth>
                              <Bottom>1.5pt</Bottom>
                            </BorderWidth>
                            <BorderColor>
                              <Default>Navy</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Left</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>20</ZIndex>
                          <rd:DefaultName>textbox18</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>Date</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox4">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BorderWidth>
                              <Bottom>1.5pt</Bottom>
                            </BorderWidth>
                            <BorderColor>
                              <Default>Navy</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Left</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>19</ZIndex>
                          <rd:DefaultName>textbox4</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>Date</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox19">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BorderWidth>
                              <Bottom>1.5pt</Bottom>
                            </BorderWidth>
                            <BorderColor>
                              <Default>Navy</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Center</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>18</ZIndex>
                          <rd:DefaultName>textbox19</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>Type</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox22">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BorderWidth>
                              <Bottom>1.5pt</Bottom>
                            </BorderWidth>
                            <BorderColor>
                              <Default>Navy</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Right</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>17</ZIndex>
                          <rd:DefaultName>textbox22</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>New Amount</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox30">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BorderWidth>
                              <Bottom>1.5pt</Bottom>
                            </BorderWidth>
                            <BorderColor>
                              <Default>Navy</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Right</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>16</ZIndex>
                          <rd:DefaultName>textbox30</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>Adj Amount</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox33">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BorderWidth>
                              <Bottom>1.5pt</Bottom>
                            </BorderWidth>
                            <BorderColor>
                              <Default>Navy</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Right</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>15</ZIndex>
                          <rd:DefaultName>textbox33</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>C</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox38">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BorderWidth>
                              <Bottom>1.5pt</Bottom>
                            </BorderWidth>
                            <BorderColor>
                              <Default>Navy</Default>
                            </BorderColor>
                            <BorderStyle>
                              <Bottom>Solid</Bottom>
                            </BorderStyle>
                            <FontSize>9pt</FontSize>
                            <TextAlign>Right</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>14</ZIndex>
                          <rd:DefaultName>textbox38</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value />
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                </TableRow>
              </TableRows>
            </Header>
            <Details>
              <TableRows>
                <TableRow>
                  <Height>0.18in</Height>
                  <TableCells>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox16">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BackgroundColor>=Iif(RowNumber("table1") Mod 2, "White", "AliceBlue")</BackgroundColor>
                            <BorderStyle>
                              <Top>None</Top>
                            </BorderStyle>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Left</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>10</ZIndex>
                          <rd:DefaultName>textbox16</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>= Fields!CONumber.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox29">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BackgroundColor>=Iif(RowNumber("table1") Mod 2, "White", "AliceBlue")</BackgroundColor>
                            <BorderStyle>
                              <Top>None</Top>
                            </BorderStyle>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Center</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>9</ZIndex>
                          <rd:DefaultName>textbox29</rd:DefaultName>
                          <Visibility>
                            <Hidden>=Iif(len(trim( Fields!CONumber.Value) )&gt;0,false,true)</Hidden>
                          </Visibility>
                          <CanGrow>true</CanGrow>
                          <Value>-</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox25">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <Format>0000</Format>
                            <BackgroundColor>=Iif(RowNumber("table1") Mod 2, "White", "AliceBlue")</BackgroundColor>
                            <BorderStyle>
                              <Top>None</Top>
                            </BorderStyle>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Left</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>8</ZIndex>
                          <rd:DefaultName>textbox25</rd:DefaultName>
                          <Visibility>
                            <Hidden>=Iif(len(trim( Fields!CONumber.Value) )&gt;0,false,true)</Hidden>
                          </Visibility>
                          <CanGrow>true</CanGrow>
                          <Value>= Fields!COSequenceNumber.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox24">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BackgroundColor>=Iif(RowNumber("table1") Mod 2, "White", "AliceBlue")</BackgroundColor>
                            <BorderStyle>
                              <Top>None</Top>
                            </BorderStyle>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Left</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>7</ZIndex>
                          <rd:DefaultName>textbox24</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>= Fields!InvoiceNumber.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox20">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <Format>=ReportLib.Language.GetDateFormat( First(Fields!DateNumberFormat.Value, "SystemConfig") )</Format>
                            <BackgroundColor>=Iif(RowNumber("table1") Mod 2, "White", "AliceBlue")</BackgroundColor>
                            <BorderStyle>
                              <Top>None</Top>
                            </BorderStyle>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Left</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>6</ZIndex>
                          <rd:DefaultName>textbox20</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>=Iif(len(trim( Fields!InvoiceNumber.Value ))&gt;0,Fields!InvoiceDate.Value,nothing)</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox5">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <Format>=ReportLib.Language.GetDateFormat( First(Fields!DateNumberFormat.Value, "SystemConfig") )</Format>
                            <BackgroundColor>=Iif(RowNumber("table1") Mod 2, "White", "AliceBlue")</BackgroundColor>
                            <BorderStyle>
                              <Top>None</Top>
                            </BorderStyle>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Left</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>5</ZIndex>
                          <rd:DefaultName>textbox5</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>= Fields!AdjustmentDate.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox21">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BackgroundColor>=Iif(RowNumber("table1") Mod 2, "White", "AliceBlue")</BackgroundColor>
                            <BorderStyle>
                              <Top>None</Top>
                            </BorderStyle>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Center</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>4</ZIndex>
                          <rd:DefaultName>textbox21</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>= Fields!AdjustmentCode.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox27">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <Format>=Iif( Parameters!CurrencyCode.Value = "L",ReportLib.Language.GetNumberFormat( First(Fields!DecimalPrecision.Value, "SystemConfig") , First(Fields!CurrencySymbol.Value, "SystemConfig") , First(Fields!CurrencySymbolPlacement.Value, "SystemConfig") ),ReportLib.Language.GetNumberFormat( First(Fields!CustDecimalPrecision.Value, "CustCurrency") , First(Fields!CustCurrencySymbol.Value, "CustCurrency") , First(Fields!CustCurrencySymbolPlacement.Value, "CustCurrency") ))</Format>
                            <BackgroundColor>=Iif(RowNumber("table1") Mod 2, "White", "AliceBlue")</BackgroundColor>
                            <BorderStyle>
                              <Top>None</Top>
                            </BorderStyle>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Right</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <Language>=ReportLib.Language.DateLanguage( First(Fields!DateNumberFormat.Value, "SystemConfig") )</Language>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>3</ZIndex>
                          <rd:DefaultName>textbox27</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>= Fields!NewAmount.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox31">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <Format>=Iif( Parameters!CurrencyCode.Value = "L",ReportLib.Language.GetNumberFormat( First(Fields!DecimalPrecision.Value, "SystemConfig") , First(Fields!CurrencySymbol.Value, "SystemConfig") , First(Fields!CurrencySymbolPlacement.Value, "SystemConfig") ),ReportLib.Language.GetNumberFormat( First(Fields!CustDecimalPrecision.Value, "CustCurrency") , First(Fields!CustCurrencySymbol.Value, "CustCurrency") , First(Fields!CustCurrencySymbolPlacement.Value, "CustCurrency") ))</Format>
                            <BackgroundColor>=Iif(RowNumber("table1") Mod 2, "White", "AliceBlue")</BackgroundColor>
                            <BorderStyle>
                              <Top>None</Top>
                            </BorderStyle>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Right</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <Language>=ReportLib.Language.DateLanguage( First(Fields!DateNumberFormat.Value, "SystemConfig") )</Language>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>2</ZIndex>
                          <rd:DefaultName>textbox31</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>= Fields!AdjustmentAmount.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox34">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BackgroundColor>=Iif(RowNumber("table1") Mod 2, "White", "AliceBlue")</BackgroundColor>
                            <BorderStyle>
                              <Top>None</Top>
                            </BorderStyle>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Right</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>1</ZIndex>
                          <rd:DefaultName>textbox34</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>= Fields!InvoiceControllingCode.Value</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="DateNumberFormat">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <BackgroundColor>=Iif(RowNumber("table1") Mod 2, "White", "AliceBlue")</BackgroundColor>
                            <BorderStyle>
                              <Top>None</Top>
                            </BorderStyle>
                            <FontSize>8pt</FontSize>
                            <VerticalAlign>Middle</VerticalAlign>
                            <TextAlign>Left</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <Visibility>
                            <Hidden>true</Hidden>
                          </Visibility>
                          <CanGrow>true</CanGrow>
                          <Value>= First(Fields!DateNumberFormat.Value, "SystemConfig")</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                </TableRow>
              </TableRows>
            </Details>
            <DataSetName>SHPI</DataSetName>
            <Top>4.57143cm</Top>
            <Footer>
              <TableRows>
                <TableRow>
                  <Height>0.2in</Height>
                  <TableCells>
                    <TableCell>
                      <ColSpan>9</ColSpan>
                      <ReportItems>
                        <Textbox Name="textbox35">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <FontSize>8pt</FontSize>
                            <TextAlign>Left</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                            <FontWeight>700</FontWeight>
                          </Style>
                          <ZIndex>13</ZIndex>
                          <rd:DefaultName>textbox35</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value>="PRINTED IN:"+Iif( Parameters!CurrencyCode.Value  = "L", First(Fields!CurrencyCodeDescription.Value, "SystemConfig") , Fields!CustCurrencyCodeDescription.Value )</Value>
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox45">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <TextAlign>Right</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>12</ZIndex>
                          <CanGrow>true</CanGrow>
                          <rd:DefaultName>textbox45</rd:DefaultName>
                          <Value />
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                    <TableCell>
                      <ReportItems>
                        <Textbox Name="textbox40">
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <TextAlign>Right</TextAlign>
                            <PaddingBottom>2pt</PaddingBottom>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                          <ZIndex>11</ZIndex>
                          <rd:DefaultName>textbox40</rd:DefaultName>
                          <CanGrow>true</CanGrow>
                          <Value />
                        </Textbox>
                      </ReportItems>
                    </TableCell>
                  </TableCells>
                </TableRow>
              </TableRows>
            </Footer>
            <TableColumns>
              <TableColumn>
                <Width>3.42857cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>0.38095cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>1.14286cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>4.57143cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>1.14286cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>1.20635cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>1.26984cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>2.85714cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>2.85714cm</Width>
              </TableColumn>
              <TableColumn>
                <Width>0.31746cm</Width>
                <Visibility>
                  <Hidden>=Iif( Fields!CustomerControllingCode.Value = "F" ,false,true)</Hidden>
                </Visibility>
              </TableColumn>
              <TableColumn>
                <Width>0.07937cm</Width>
              </TableColumn>
            </TableColumns>
          </Table>
          <Textbox Name="textbox1">
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <TextAlign>Center</TextAlign>
              <PaddingBottom>2pt</PaddingBottom>
              <PaddingTop>2pt</PaddingTop>
              <PaddingRight>2pt</PaddingRight>
            </Style>
            <ZIndex>10</ZIndex>
            <rd:DefaultName>textbox1</rd:DefaultName>
            <Height>0.225in</Height>
            <Width>4.06443in</Width>
            <CanGrow>true</CanGrow>
            <Value>= First(Fields!CompanyName.Value, "SystemConfig")</Value>
            <Left>1.61258in</Left>
          </Textbox>
          <Textbox Name="txt16">
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <FontSize>12pt</FontSize>
              <TextAlign>Center</TextAlign>
              <Color>Navy</Color>
              <PaddingBottom>2pt</PaddingBottom>
              <PaddingTop>2pt</PaddingTop>
              <PaddingRight>2pt</PaddingRight>
              <FontWeight>700</FontWeight>
            </Style>
            <ZIndex>9</ZIndex>
            <Height>0.3in</Height>
            <Width>3.09784in</Width>
            <Top>0.3in</Top>
            <CanGrow>true</CanGrow>
            <Value>Invoice Adjustments</Value>
            <Left>2.13261in</Left>
          </Textbox>
          <Textbox Name="textbox14">
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <FontSize>8pt</FontSize>
              <PaddingBottom>2pt</PaddingBottom>
              <PaddingTop>2pt</PaddingTop>
              <PaddingRight>2pt</PaddingRight>
            </Style>
            <ZIndex>8</ZIndex>
            <rd:DefaultName>textbox14</rd:DefaultName>
            <Height>0.80581cm</Height>
            <Width>2.53968cm</Width>
            <Top>0.76191cm</Top>
            <CanGrow>true</CanGrow>
            <Value>Function: IVIA</Value>
          </Textbox>
          <Textbox Name="textbox26">
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <FontSize>8pt</FontSize>
              <TextAlign>Left</TextAlign>
              <PaddingBottom>2pt</PaddingBottom>
              <PaddingTop>2pt</PaddingTop>
              <PaddingRight>2pt</PaddingRight>
              <FontWeight>700</FontWeight>
            </Style>
            <ZIndex>7</ZIndex>
            <Height>0.63492cm</Height>
            <Width>4.8254cm</Width>
            <Top>2.4127cm</Top>
            <CanGrow>true</CanGrow>
            <Value>= Fields!CustomerID.Value</Value>
            <Left>3.66931cm</Left>
          </Textbox>
          <Textbox Name="textbox36">
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <FontSize>8pt</FontSize>
              <TextAlign>Right</TextAlign>
              <PaddingBottom>2pt</PaddingBottom>
              <PaddingTop>2pt</PaddingTop>
              <PaddingRight>2pt</PaddingRight>
              <FontWeight>700</FontWeight>
            </Style>
            <ZIndex>6</ZIndex>
            <Height>0.63492cm</Height>
            <Width>2.33598cm</Width>
            <Top>2.4127cm</Top>
            <CanGrow>true</CanGrow>
            <Value>Customer ID:</Value>
            <Left>1.20635cm</Left>
          </Textbox>
          <Textbox Name="textbox3">
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <FontSize>8pt</FontSize>
              <TextAlign>Left</TextAlign>
              <PaddingBottom>2pt</PaddingBottom>
              <PaddingTop>2pt</PaddingTop>
              <PaddingRight>2pt</PaddingRight>
              <FontWeight>700</FontWeight>
            </Style>
            <ZIndex>5</ZIndex>
            <Height>0.63492cm</Height>
            <Width>5.85449cm</Width>
            <Top>2.4127cm</Top>
            <CanGrow>true</CanGrow>
            <Value>= Fields!CustomerName.Value</Value>
            <Left>11.46561cm</Left>
          </Textbox>
          <Textbox Name="textbox7">
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <FontSize>8pt</FontSize>
              <TextAlign>Right</TextAlign>
              <PaddingBottom>2pt</PaddingBottom>
              <PaddingTop>2pt</PaddingTop>
              <PaddingRight>2pt</PaddingRight>
              <FontWeight>700</FontWeight>
            </Style>
            <ZIndex>4</ZIndex>
            <Height>0.63492cm</Height>
            <Width>2.78042cm</Width>
            <Top>2.4127cm</Top>
            <CanGrow>true</CanGrow>
            <Value>Customer Name:</Value>
            <Left>8.5582cm</Left>
          </Textbox>
          <Textbox Name="textbox8">
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <FontSize>8pt</FontSize>
              <TextAlign>Right</TextAlign>
              <PaddingBottom>2pt</PaddingBottom>
              <PaddingTop>2pt</PaddingTop>
              <PaddingRight>2pt</PaddingRight>
              <FontWeight>700</FontWeight>
            </Style>
            <ZIndex>3</ZIndex>
            <Height>0.63492cm</Height>
            <Width>2.79365cm</Width>
            <Top>3.68254cm</Top>
            <CanGrow>true</CanGrow>
            <Value>= Iif( Parameters!Set_Mode.Value = "R", Parameters!From.Value ,Nothing)</Value>
            <Left>5.82805cm</Left>
          </Textbox>
          <Textbox Name="textbox10">
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <FontSize>8pt</FontSize>
              <TextAlign>Right</TextAlign>
              <PaddingBottom>2pt</PaddingBottom>
              <PaddingTop>2pt</PaddingTop>
              <PaddingRight>2pt</PaddingRight>
              <FontWeight>700</FontWeight>
            </Style>
            <ZIndex>2</ZIndex>
            <Height>0.63492cm</Height>
            <Width>2.92064cm</Width>
            <Top>3.68254cm</Top>
            <CanGrow>true</CanGrow>
            <Value>Starting Ref No:</Value>
            <Left>2.78043cm</Left>
          </Textbox>
          <Textbox Name="textbox11">
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <FontSize>8pt</FontSize>
              <TextAlign>Right</TextAlign>
              <PaddingBottom>2pt</PaddingBottom>
              <PaddingTop>2pt</PaddingTop>
              <PaddingRight>2pt</PaddingRight>
              <FontWeight>700</FontWeight>
            </Style>
            <ZIndex>1</ZIndex>
            <Height>0.63492cm</Height>
            <Width>2.79365cm</Width>
            <Top>3.68254cm</Top>
            <CanGrow>true</CanGrow>
            <Value>= Iif( Parameters!Set_Mode.Value = "I", Parameters!From.Value ,Nothing)</Value>
            <Left>12.81217cm</Left>
          </Textbox>
          <Textbox Name="textbox12">
            <Style>
              <PaddingLeft>2pt</PaddingLeft>
              <FontSize>8pt</FontSize>
              <TextAlign>Right</TextAlign>
              <PaddingBottom>2pt</PaddingBottom>
              <PaddingTop>2pt</PaddingTop>
              <PaddingRight>2pt</PaddingRight>
              <FontWeight>700</FontWeight>
            </Style>
            <Height>0.63492cm</Height>
            <Width>3.80952cm</Width>
            <Top>3.68254cm</Top>
            <CanGrow>true</CanGrow>
            <Value>Or Starting Invoice No:</Value>
            <Left>8.87566cm</Left>
          </Textbox>
        </ReportItems>
      </List>
    </ReportItems>
    <Style>
      <BorderColor>
        <Bottom>DarkBlue</Bottom>
      </BorderColor>
    </Style>
    <Height>2.63in</Height>
    <ColumnSpacing>0in</ColumnSpacing>
  </Body>
  <TopMargin>1in</TopMargin>
  <DataSources>
    <DataSource Name="FSDB">
      <rd:DataSourceID>cb3dd503-37ad-4257-9757-7e7344de9429</rd:DataSourceID>
      <DataSourceReference>FSDB</DataSourceReference>
    </DataSource>
  </DataSources>
  <Code>



Public shared function DecideMOCO (ByVal MOCO As string,ByVal value As string) As String
	If MOCO =""
		DecideMOCO =""
	Else DecideMOCO = value
	End If 
End Function
</Code>
  <Width>7.58125in</Width>
  <DataSets>
    <DataSet Name="SystemConfig">
      <Fields>
        <Field Name="CompanyName">
          <DataField>CompanyName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CompanyAddress1">
          <DataField>CompanyAddress1</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CompanyCity">
          <DataField>CompanyCity</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CompanyState">
          <DataField>CompanyState</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CompanyCountry">
          <DataField>CompanyCountry</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CompanyZip">
          <DataField>CompanyZip</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DateNumberFormat">
          <DataField>DateNumberFormat</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CurrencySymbol">
          <DataField>CurrencySymbol</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DecimalPrecision">
          <DataField>DecimalPrecision</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CurrencyCode">
          <DataField>CurrencyCode</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CurrencySymbolPlacement">
          <DataField>CurrencySymbolPlacement</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CurrencyCodeDescription">
          <DataField>CurrencyCodeDescription</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>FSDB</DataSourceName>
        <CommandText>select 	CompanyName
        ,CompanyAddress1
        ,CompanyCity
        ,CompanyState
        ,CompanyCountry
        ,CompanyZip
	, DateNumberFormat
	, CurrencySymbol
	, s.DecimalPrecision
              ,c.CurrencyCode
	, CurrencySymbolPlacement
	,CurrencyCodeDescription
from 	FS_SystemConfig s
	,FS_CurrencyCode c
where	c.CurrencyCode='00000'</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="IVIA">
      <Fields>
        <Field Name="CustomerID">
          <DataField>CustomerID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustomerName">
          <DataField>CustomerName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CONumber">
          <DataField>CONumber</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="COSequenceNumber">
          <DataField>COSequenceNumber</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
        <Field Name="InvoiceNumber">
          <DataField>InvoiceNumber</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="InvoiceDate">
          <DataField>InvoiceDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="InvoiceControllingCode">
          <DataField>InvoiceControllingCode</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="AdjustmentDate">
          <DataField>AdjustmentDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="AdjustmentCode">
          <DataField>AdjustmentCode</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="NewAmount">
          <DataField>NewAmount</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="AdjustmentAmount">
          <DataField>AdjustmentAmount</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="CustomerControllingCode">
          <DataField>CustomerControllingCode</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustomerCurrencyCode">
          <DataField>CustomerCurrencyCode</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustDecimalPrecision">
          <DataField>CustDecimalPrecision</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
        <Field Name="CustCurrencySymbol">
          <DataField>CustCurrencySymbol</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustCurrencySymbolPlacement">
          <DataField>CustCurrencySymbolPlacement</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustCurrencyCodeDescription">
          <DataField>CustCurrencyCodeDescription</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>FSDB</DataSourceName>
        <CommandText>-----------------------------------------------------------------------------------------------------------
-- NAME:	IVIA
-- COPYRIGHT: Copyright 2004, SoftBrands Corporation. All rights reserved.
-- REVISION:  $Revision: $
--
-- FUNCTION:  
--                   
--	        
--	        
--	        
-------------------------------------------------------------------------------------------------------------

declare @vcFrom varchar(30)
set @vcFrom = case when @From = '0' then ' '
              else @From end

if (@Set_Mode = 'R' and @CurrencyCode = 'L') 

select 
T2.CustomerID
,T2.CustomerName
,T1.CONumber
,T1.COSequenceNumber
,T1.InvoiceNumber
,T1.InvoiceDate
,T1.InvoiceControllingCode
,T1.AdjustmentDate
,T1.AdjustmentCode
,T1.InvoiceLocalEndingBalance NewAmount
,T1.AdjustmentLocalAmount AdjustmentAmount
,T2.CustomerControllingCode
,T2.CustomerCurrencyCode
,T3.DecimalPrecision CustDecimalPrecision
,T3.CurrencySymbol CustCurrencySymbol
,T3.CurrencySymbolPlacement CustCurrencySymbolPlacement
,T3.CurrencyCodeDescription CustCurrencyCodeDescription
from FS_ARInvoiceAdjustmentHistory T1 (READUNCOMMITTED) 
left join FS_Customer T2  (READUNCOMMITTED) on (T1.CustomerKey = T2.CustomerKey)
left join FS_CurrencyCode T3 (READUNCOMMITTED) on (T2.CustomerCurrencyCode = T3.CurrencyCode)

where T2.CustomerID = @CustID
and T1.CONumber &gt;= @vcFrom
and T1.CONumber &lt;= @To
order by T1.CONumber, T1.COSequenceNumber, T1.AdjustmentDate, T1.ARInvoiceAdjustmentHistoryKey


if (@Set_Mode = 'R' and @CurrencyCode = 'F') 

select 
T2.CustomerID
,T2.CustomerName
,T1.CONumber
,T1.COSequenceNumber
,T1.InvoiceNumber
,T1.InvoiceDate
,T1.InvoiceControllingCode
,T1.AdjustmentDate
,T1.AdjustmentCode
,T1.InvoiceForeignEndingBalance NewAmount
,T1.AdjustmentForeignAmount AdjustmentAmount
,T2.CustomerControllingCode
,T2.CustomerCurrencyCode
,T3.DecimalPrecision CustDecimalPrecision
,T3.CurrencySymbol CustCurrencySymbol
,T3.CurrencySymbolPlacement CustCurrencySymbolPlacement
,T3.CurrencyCodeDescription CustCurrencyCodeDescription
from FS_ARInvoiceAdjustmentHistory T1 (READUNCOMMITTED) 
left join FS_Customer T2  (READUNCOMMITTED) on (T1.CustomerKey = T2.CustomerKey)
left join FS_CurrencyCode T3 (READUNCOMMITTED) on (T2.CustomerCurrencyCode = T3.CurrencyCode)

where T2.CustomerID = @CustID
and T1.CONumber &gt;= @vcFrom
and T1.CONumber &lt;= @To
order by T1.CONumber, T1.COSequenceNumber, T1.AdjustmentDate, T1.ARInvoiceAdjustmentHistoryKey


if (@Set_Mode = 'I' and @CurrencyCode = 'L') 

select 
T2.CustomerID
,T2.CustomerName

,T1.CONumber
,T1.COSequenceNumber
,T1.InvoiceNumber
,T1.InvoiceDate
,T1.InvoiceControllingCode
,T1.AdjustmentDate
,T1.AdjustmentCode
,T1.InvoiceLocalEndingBalance NewAmount
,T1.AdjustmentLocalAmount AdjustmentAmount
,T2.CustomerControllingCode
,T2.CustomerCurrencyCode
,T3.DecimalPrecision CustDecimalPrecision
,T3.CurrencySymbol CustCurrencySymbol
,T3.CurrencySymbolPlacement CustCurrencySymbolPlacement
,T3.CurrencyCodeDescription CustCurrencyCodeDescription
from FS_ARInvoiceAdjustmentHistory T1 (READUNCOMMITTED) 
left join FS_Customer T2  (READUNCOMMITTED) on (T1.CustomerKey = T2.CustomerKey)
left join FS_CurrencyCode T3 (READUNCOMMITTED) on (T2.CustomerCurrencyCode = T3.CurrencyCode)

where T2.CustomerID = @CustID 
and T1.InvoiceNumber &gt;=@vcFrom
and T1.InvoiceNumber &lt;=@To
order by T1.InvoiceNumber, T1.AdjustmentDate, T1.ARInvoiceAdjustmentHistoryKey


if (@Set_Mode = 'I'and @CurrencyCode = 'F') 

select 
T2.CustomerID
,T2.CustomerName
,T1.CONumber
,T1.COSequenceNumber
,T1.InvoiceNumber
,T1.InvoiceDate
,T1.InvoiceControllingCode
,T1.AdjustmentDate
,T1.AdjustmentCode
,T1.InvoiceForeignEndingBalance NewAmount
,T1.AdjustmentForeignAmount AdjustmentAmount
,T2.CustomerControllingCode
,T2.CustomerCurrencyCode
,T3.DecimalPrecision CustDecimalPrecision
,T3.CurrencySymbol CustCurrencySymbol
,T3.CurrencySymbolPlacement CustCurrencySymbolPlacement
,T3.CurrencyCodeDescription CustCurrencyCodeDescription
from FS_ARInvoiceAdjustmentHistory T1 (READUNCOMMITTED) 
left join FS_Customer T2  (READUNCOMMITTED) on (T1.CustomerKey = T2.CustomerKey)
left join FS_CurrencyCode T3 (READUNCOMMITTED) on (T2.CustomerCurrencyCode = T3.CurrencyCode)

where T2.CustomerID = @CustID 
and T1.InvoiceNumber &gt;=@vcFrom
and T1.InvoiceNumber &lt;=@To
order by T1.InvoiceNumber, T1.AdjustmentDate, T1.ARInvoiceAdjustmentHistoryKey</CommandText>
        <QueryParameters>
          <QueryParameter Name="@Set_Mode">
            <Value>=Parameters!Set_Mode.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@CurrencyCode">
            <Value>=Parameters!CurrencyCode.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@CustID">
            <Value>=Parameters!CustID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@From">
            <Value>=Parameters!From.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@To">
            <Value>=Parameters!To.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="CustCurrency">
      <Fields>
        <Field Name="CustomerID">
          <DataField>CustomerID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustCurrencyCode">
          <DataField>CustCurrencyCode</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustDecimalPrecision">
          <DataField>CustDecimalPrecision</DataField>
          <rd:TypeName>System.Int16</rd:TypeName>
        </Field>
        <Field Name="CustCurrencySymbol">
          <DataField>CustCurrencySymbol</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CustCurrencySymbolPlacement">
          <DataField>CustCurrencySymbolPlacement</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>FSDB</DataSourceName>
        <CommandText>select 
T1.CustomerID
,T2.CurrencyCode CustCurrencyCode
,T2.DecimalPrecision CustDecimalPrecision
,T2.CurrencySymbol CustCurrencySymbol
,T2.CurrencySymbolPlacement CustCurrencySymbolPlacement
from dbo.FS_Customer T1
left join dbo.FS_CurrencyCode T2 on T1.CustomerCurrencyCode = T2.CurrencyCode
Where T1.CustomerID = @CustID</CommandText>
        <QueryParameters>
          <QueryParameter Name="@CustID">
            <Value>=Parameters!CustID.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
  </DataSets>
  <LeftMargin>0.4in</LeftMargin>
  <rd:SnapToGrid>true</rd:SnapToGrid>
  <rd:DrawGrid>true</rd:DrawGrid>
  <Description>A/R Invoice Adjustments</Description>
  <rd:ReportID>9d7f02b0-990c-4098-a34c-6419dbdb043c</rd:ReportID>
  <PageFooter>
    <ReportItems>
      <Textbox Name="RevisionLog">
        <Style>
          <PaddingLeft>2pt</PaddingLeft>
          <FontSize>8pt</FontSize>
          <TextAlign>Left</TextAlign>
          <PaddingBottom>2pt</PaddingBottom>
          <PaddingTop>2pt</PaddingTop>
          <PaddingRight>2pt</PaddingRight>
        </Style>
        <ZIndex>1</ZIndex>
        <Width>1.67708in</Width>
        <Visibility>
          <Hidden>true</Hidden>
        </Visibility>
        <Top>0.17813in</Top>
        <CanGrow>true</CanGrow>
        <Value>="05/10/04 initial revision.
SDR52286:Change the description of the parameter CurrencyCode from 'Controlling Currency' to 'Currency'.
"</Value>
        <Left>1.75729in</Left>
      </Textbox>
      <Textbox Name="ReportName">
        <Style>
          <PaddingLeft>2pt</PaddingLeft>
          <FontSize>8pt</FontSize>
          <TextAlign>Left</TextAlign>
          <PaddingBottom>2pt</PaddingBottom>
          <PaddingTop>2pt</PaddingTop>
          <PaddingRight>2pt</PaddingRight>
        </Style>
        <Height>0.25in</Height>
        <Width>1.67708in</Width>
        <Visibility>
          <Hidden>=iif(Globals!PageNumber=Globals!TotalPages, false,true)</Hidden>
        </Visibility>
        <Top>0.16875in</Top>
        <CanGrow>true</CanGrow>
        <Value>= "ArsIvia.rdl 7.4.03"</Value>
      </Textbox>
    </ReportItems>
    <PrintOnLastPage>true</PrintOnLastPage>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <Style />
    <Height>0.42812in</Height>
  </PageFooter>
  <BottomMargin>1in</BottomMargin>
  <ReportParameters>
    <ReportParameter Name="From">
      <DataType>String</DataType>
      <Prompt>From</Prompt>
    </ReportParameter>
    <ReportParameter Name="To">
      <DataType>String</DataType>
      <Prompt>Thru</Prompt>
    </ReportParameter>
    <ReportParameter Name="Set_Mode">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>R</Value>
        </Values>
      </DefaultValue>
      <Prompt>Starting Reference No or Invoice No</Prompt>
    </ReportParameter>
    <ReportParameter Name="CustID">
      <DataType>String</DataType>
      <Prompt>Customer Number</Prompt>
    </ReportParameter>
    <ReportParameter Name="CurrencyCode">
      <DataType>String</DataType>
      <Prompt>Currency</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>L</Value>
            <Label>Local</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>F</Value>
            <Label>Foreign</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
  </ReportParameters>
</Report>